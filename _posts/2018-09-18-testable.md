---
layout: post
title: 테스트가 쉬운 코드와 어려운 코드
tags: [swift, unittest, xctest]
---
테스트를 얼마나 쉽게 할수 있는지를 테스트 용이성이라 부릅니다.  
같은 기능을 하는 코드도 어떻게 작성하는지에 따라 테스트 용이성이 달라집니다.  
테스트가 어려운 코드를 먼저 작성해보고, 이를 수정하여 테스트가 쉬워지는 코드로 리팩토링을 진행해봅니다.  
  
### 테스트가 어려운 코드
특정 검색어를 입력하면 검색어와 매치되어 자동완성된 키워드들을 받는 시나리오 입니다.  
입력은 언제든지 들어올 수 있으며 자동완성되기 전 단어가 바뀐다면, 이전 요청은 취소하고 새로운 단어로 다시 요청합니다.  
ViewModel 혹은 Presenter와 같이 Mediator의 역할을 하는 클래스라 가정합니다.  
{% highlight swift %}
// Rx, Promise 등 외부 라이브러리를 제외한 순수한 swift로 작성했습니다.  
code1
code2
code3
{% endhighlight %}
위 코드의 문제점  
  
#### 위 코드를 테스트 하는 방법  
OHHTTPStubs
  
### 리팩토링
작은 수정으로 얻을 수 있는 네트워크 모듈에 대한 의존성을 주입 받는 방법과  
더 많은 코드르 작성해야 하지만, 변화에 유연함과 재사용성이 증가하는 서비스 분리로 리팩토링을 해봅니다.  

#### 네트워크 인젝션

#### 서비스로 분리


